1) –í–µ—Ä—Å–∏—è —ç—Ç–∞–ø–∞: v0.1
2) –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:
- –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–µ–Ω —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ —Å–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π –∫–∞—Ä–∫–∞—Å –±–æ—Ç–∞ –Ω–∞ aiogram 3.x –¥–ª—è –º–æ–¥—É–ª—è ¬´–ì–æ—Ä–æ—Å–∫–æ–ø¬ª
- –ù–∞—Å—Ç—Ä–æ–µ–Ω –∫–æ–Ω—Ñ–∏–≥ —á–µ—Ä–µ–∑ pydantic-settings —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –ø—Ä–∏–º–µ—Ä–æ–º .env
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î SQLite —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ (users, quotas, requests_log)
- –î–æ–±–∞–≤–ª–µ–Ω —Å–µ—Ä–≤–∏—Å –∫–≤–æ—Ç —Å —É—á—ë—Ç–æ–º –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—Ç–æ–º –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å PaymentService –∏ stub-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –±—É–¥—É—â–µ–π –æ–ø–ª–∞—Ç—ã
- –î–æ–±–∞–≤–ª–µ–Ω AIService —Å –∑–∞–≥–ª—É—à–∫–æ–π –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ OpenAI –ø–æ —Ñ–ª–∞–≥—É USE_OPENAI
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω PromptBuilder –∏ —à–∞–±–ª–æ–Ω –¥–ª—è –≥–æ—Ä–æ—Å–∫–æ–ø–æ–≤
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å –∏ —Ñ–∞–π–ª (rotating)
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω FSM-—Ñ–ª–æ—É —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è ¬´–ù–∞ —Å–µ–≥–æ–¥–Ω—è/–ù–∞ –Ω–µ–¥–µ–ª—é¬ª —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –¥–∞—Ç/–≤—Ä–µ–º–µ–Ω–∏
- –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (–±–µ–∑ ¬´–º–µ—Ä—Ç–≤—ã—Ö¬ª –∫–Ω–æ–ø–æ–∫), —ç–∫—Ä–∞–Ω—ã –±–∞–ª–∞–Ω—Å–∞ –∏ –ª–∏–º–∏—Ç–∞
- –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω README —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ –∑–∞–ø—É—Å–∫—É
3) –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ:
- python -m compileall app bot.py ‚Üí —É—Å–ø–µ—à–Ω–æ
4) –ß—Ç–æ –ù–ï —Å–¥–µ–ª–∞–Ω–æ:
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π (—Ç–æ–ª—å–∫–æ –∑–∞–≥–ª—É—à–∫–∞)
- –ù–∞—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –∫–∞–∫ —ç–∫—Ä–∞–Ω ¬´–°–∫–æ—Ä–æ¬ª
- –ù–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ OpenAI –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (—Ä–∞–±–æ—Ç–∞–µ—Ç stub)
5) –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å:
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: pip install -r requirements.txt
- –°–æ–∑–¥–∞—Ç—å .env –ø–æ –æ–±—Ä–∞–∑—Ü—É .env.example –∏ –ø—Ä–æ–ø–∏—Å–∞—Ç—å BOT_TOKEN
- –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞: python bot.py
6) –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env):
- BOT_TOKEN=
- USE_OPENAI=false
- OPENAI_API_KEY=
- LOG_LEVEL=INFO
- DB_PATH=bot.db
7) –ö–∞—Ä—Ç–∞ –∫–Ω–æ–ø–æ–∫/–∫–æ–ª–ª–±–µ–∫–æ–≤:
| –ö–Ω–æ–ø–∫–∞ | callback_data | handler |
| --- | --- | --- |
| üîÆ –ì–æ—Ä–æ—Å–∫–æ–ø | menu_horoscope | open_horoscope |
| ‚≠ê –ë–∞–ª–∞–Ω—Å | menu_balance | balance |
| ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ | menu_settings | settings |
| ‚ÑπÔ∏è –û –ø—Ä–æ–µ–∫—Ç–µ | menu_about | about |
| ‚òÄÔ∏è –ù–∞ —Å–µ–≥–æ–¥–Ω—è | hs_today | start_horoscope |
| üìÜ –ù–∞ –Ω–µ–¥–µ–ª—é | hs_week | start_horoscope |
| üß¨ –ù–∞—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ | hs_natal | natal_soon |
| ‚¨ÖÔ∏è –ù–∞–∑–∞–¥ (–∫ –≥–ª–∞–≤–Ω–æ–º—É) | back_main | back_to_main |
| ‚¨ÖÔ∏è –ù–∞–∑–∞–¥ (–∫ –≥–æ—Ä–æ—Å–∫–æ–ø—É) | back_horoscope | back_horoscope |
| –ó–Ω–∞—é | time_yes | time_known |
| –ù–µ –∑–Ω–∞—é | time_no | time_known |
| –ú | gender_m | gender |
| –ñ | gender_f | gender |
| –î—Ä—É–≥–æ–µ | gender_o | gender |
| –õ—é–±–æ–≤—å | focus_love | focus |
| –§–∏–Ω–∞–Ω—Å—ã | focus_money | focus |
| –ó–¥–æ—Ä–æ–≤—å–µ | focus_health | focus |
| –ö–∞—Ä—å–µ—Ä–∞ | focus_career | focus |
| –û–±—â–µ–µ | focus_general | focus |
| üîÅ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–∞–Ω–æ–≤–æ | regen | regenerate |
| ‚≠ê –ö—É–ø–∏—Ç—å –∑–∞–ø—Ä–æ—Å | limit_buy | limit_stub |
| üíé –ü–æ–¥–ø–∏—Å–∫–∞ | limit_sub | limit_stub |
| üè† –í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é | back_main | back_to_main |
8) FSM flow:
- start_horoscope ‚Üí waiting_for_birth_date ‚Üí waiting_for_time_known ‚Üí (waiting_for_birth_time) ‚Üí waiting_for_birth_place ‚Üí waiting_for_gender ‚Üí waiting_for_focus ‚Üí waiting_for_regeneration
9) –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤:
- bot.py
- requirements.txt
- README.md
- .env.example
- app/config/settings.py
- app/core/{logging.py,router.py,states.py,keyboards.py,texts.py,validators.py}
- app/db/{migrations.py,storage.py,models.sql}
- app/services/{quota_service.py,payment_service.py,ai_service.py,prompt_builder.py}
- app/modules/horoscope/{handlers.py,prompts.py}
- HANDOFF_FOR_ANNA.md
10) –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã/—Ä–∏—Å–∫–∏:
- –ë–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ BOT_TOKEN –±–æ—Ç –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è
- –ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ USE_OPENAI —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–∞–ª–∏–¥–Ω—ã–π OPENAI_API_KEY
- –û–ø–ª–∞—Ç–∞ –∏ –Ω–∞—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ –ø–æ–∫–∞ –∑–∞–≥–ª—É—à–∫–∏
11) –°–ª–µ–¥—É—é—â–∏–π –ª–æ–≥–∏—á–Ω—ã–π —ç—Ç–∞–ø:
- –ü–æ–¥–∫–ª—é—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π AI-–ø—Ä–æ–≤–∞–π–¥–µ—Ä –∏ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ–º–ø—Ç—ã/—Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–æ–≤
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–ø–ª–∞—Ç—É (Telegram Stars/–¥—Ä—É–≥–∞—è) –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–≤–æ—Ç
- –î–æ–±–∞–≤–∏—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ UI –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
